import{o as d,c as i,b as s,d as a,a as l}from"./app.60568e47.js";import{_ as e}from"./plugin-vue_export-helper.21dcd24c.js";const n={},o={"data-v-1605a430":""},c=s("h1",{"data-v-1605a430":"",class:"main-title"}," 12 | \u6027\u80FD\u5206\u6790\uFF1A\u6027\u80FD\u5F71\u54CD\u7684\u5173\u952E\u8DEF\u5F84\u4EE5\u53CA\u4F18\u5316\u7B56\u7565 ",-1),r=a(),p=s("div",{"data-v-1605a430":"",class:"main-tips"},[a(" 2021/04/12 "),s("span",{"data-v-1605a430":"",class:"auth"},"\u6E05\u5F26")],-1),t=a(),v=s("div",{"data-v-1605a430":"",class:"media-player-wrap"},[s("div",{"data-v-6ecd2302":"","data-v-1605a430":""},[s("div",{"data-v-6ecd2302":"",class:"media-container"},[s("div",{"data-v-6ecd2302":"",class:"button-wrap inline-block"},[s("div",{"data-v-6ecd2302":"",class:"button-icon inline-block"})]),a(),s("div",{"data-v-6ecd2302":"",class:"data-wrap inline-block"},[s("div",{"data-v-6ecd2302":"",class:"progress-bar"},[s("div",{class:"vue-slider vue-slider-ltr",style:{padding:"7px 0px",width:"auto",height:"4px"}},[s("div",{class:"vue-slider-rail",style:{height:"2px",background:"rgb(213, 218, 223)","border-radius":"1.5px"}},[s("div",{class:"vue-slider-process",style:{height:"100%",top:"0px",left:"0%",width:"0%","transition-property":"width, left","transition-duration":"0.5s",background:"rgb(252, 215, 102)"}}),s("div",{"aria-valuetext":"00:00/12:44",class:"vue-slider-dot vue-slider-dot-hover",role:"slider","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"764","aria-orientation":"horizontal",tabindex:"0",style:{width:"14px",height:"14px",transform:"translate(-50%, -50%)",top:"50%",left:"0%",transition:"left 0.5s ease 0s"}},[s("div",{class:"vue-slider-dot-handle",style:{width:"16px",height:"16px",background:"rgb(252, 215, 102)","box-shadow":"none","margin-top":"-1px","z-index":"1"}}),s("div",{class:"vue-slider-dot-tooltip vue-slider-dot-tooltip-top"},[s("div",{class:"vue-slider-dot-tooltip-inner vue-slider-dot-tooltip-inner-top",style:{padding:"2px 12px","border-radius":"14px","font-size":"14px",color:"rgb(0, 0, 0)",background:"rgb(252, 215, 102)","min-width":"20px","border-color":"rgb(252, 215, 102)"}},[s("span",{class:"vue-slider-dot-tooltip-text"},"00:00/12:44")])])])])])]),a(),s("div",{"data-v-6ecd2302":"",class:"detail-wrap"},[s("div",{"data-v-6ecd2302":"",class:"detail-one"}," 33.21M "),a(),s("div",{"data-v-6ecd2302":"",class:"detail-two"}," 00:00/12:44 ")])]),a(),s("div",{"data-v-6ecd2302":"",class:"division-line inline-block"}),a(),s("div",{"data-v-6ecd2302":"",class:"viedo-wrap inline-block"},[s("div",{"data-v-6ecd2302":"",class:"viedo-icon"}),a(),s("div",{"data-v-6ecd2302":"",class:"text"}," \u770B\u89C6\u9891 ")])])])],-1),h=l(` <div data-v-1605a430="" class="main-container"><div data-v-1605a430="" class="rich-text-wrap"><p data-nodeid="191125">\u6A21\u5757\u4E00\u7684<a href="https://kaiwu.lagou.com/course/courseInfo.htm?courseId=694#/detail/pc?id=6788&amp;fileGuid=xxQTRXtVcqtHK6j8" data-nodeid="191666">\u300A06 | \u54EA\u4E9B\u56E0\u7D20\u4F1A\u5F71\u54CD Node.js \u6027\u80FD\uFF1F\u300B</a>\uFF0C\u6211\u4EEC\u8BE6\u7EC6\u8BB2\u89E3\u4E86\u5F71\u54CD\u5230 Node.js \u6027\u80FD\u7684\u4E00\u4E9B\u56E0\u7D20\uFF0C\u4F46\u662F\u5728\u5B9E\u9645\u5F00\u53D1\u8FC7\u7A0B\u4E2D\uFF0C\u6211\u4EEC\u5E94\u8BE5\u5982\u4F55\u53BB\u5B9A\u4F4D\u5F71\u54CD\u6027\u80FD\u7684\u5173\u952E\u56E0\u7D20\u5462\uFF1F\u5B9A\u4F4D\u5230\u6027\u80FD\u95EE\u9898\u540E\uFF0C\u53C8\u8BE5\u5982\u4F55\u53BB\u4F18\u5316\u8FD9\u90E8\u5206\u529F\u80FD\u5462\uFF1F\u4EE5\u4E0A\u5C31\u662F\u672C\u8BB2\u8981\u4ECB\u7ECD\u7684\u6838\u5FC3\u77E5\u8BC6\u70B9\u3002</p><h3 data-nodeid="191126">\u5DE5\u5177\u4ECB\u7ECD</h3><p data-nodeid="191127">\u5728\u8BB2\u89E3\u6027\u80FD\u5206\u6790\u5B9E\u8DF5\u4E4B\u524D\uFF0C\u6211\u4EEC\u5148\u6765\u770B\u770B\u6027\u80FD\u5206\u6790\u6240\u5E94\u7528\u7684\u4E24\u4E2A\u6BD4\u8F83\u5173\u952E\u7684\u5DE5\u5177\uFF1A</p><ul data-nodeid="191128"><li data-nodeid="191129"><p data-nodeid="191130">\u538B\u6D4B\u6240\u4F7F\u7528\u5230\u7684 WRK\uFF08Windows Research Kernel\uFF09\uFF1B</p></li><li data-nodeid="191131"><p data-nodeid="191132">\u6027\u80FD\u5206\u6790\u6240\u4F7F\u7528\u5230\u7684 Chrome \u5206\u6790\u5DE5\u5177 JavaScript Profile\u3002</p></li></ul><h4 data-nodeid="191133">WRK \u7684\u5B89\u88C5\u53CA\u53C2\u6570</h4><p data-nodeid="191134">\u5728\u538B\u6D4B\u5DE5\u5177\u4E0A\u53EF\u9009\u62E9\u7684\u6BD4\u8F83\u591A\uFF0C\u6BD4\u5982 Apache-ab \u538B\u6D4B\u5DE5\u5177\u3001Siege \u53CA\u672C\u8BB2\u6240\u5E94\u7528\u7684 WRK\u3002<strong data-nodeid="191678">\u4E3A\u4E86\u80FD\u591F\u66F4\u597D\u5730\u5229\u7528\u591A\u6838\u7684\u591A\u7EBF\u7A0B\u5E76\u53D1\u6D4B\u8BD5\uFF0C\u8FD9\u91CC\u6211\u4EEC\u9009\u62E9\u4F7F\u7528 WRK \u6765\u4F5C\u4E3A\u538B\u6D4B\u5DE5\u5177</strong>\u3002\u6211\u4EEC\u770B\u4E0B\u8BE5\u5DE5\u5177\u7684\u5B89\u88C5\u4EE5\u53CA\u4E00\u4E9B\u5E38\u7528\u53C2\u6570\u3002</p><ul data-nodeid="191135"><li data-nodeid="191136"><p data-nodeid="191137">\u5728<strong data-nodeid="191684">Mac</strong>\u4E0A\u4F7F\u7528\u8F6F\u4EF6\u5305\u7BA1\u7406\u5DE5\u5177 Homebrew \u6765\u5B89\u88C5\uFF0C\u4F7F\u7528\u5982\u4E0B\u547D\u4EE4\u5373\u53EF\uFF1A</p></li></ul><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="powershell"><ol><li><div class="code-word">brew install wrk\r
</div></li></ol></code></pre></div><ul data-nodeid="191139"><li data-nodeid="191140"><p data-nodeid="191141">\u5728<strong data-nodeid="191690">Linux</strong>\u4E0A\u4F9D\u6B21\u6267\u884C\u2026\u2026\u7684\u547D\u4EE4\u5B89\u88C5\u5C31\u53EF\u4EE5\uFF08\u5982\u679C Linux \u4E0A\u6CA1\u6709\u5B89\u88C5 GCC\u3001Make \u6216\u8005 Git\uFF0C\u5C31\u9700\u8981\u5148\u5B89\u88C5\u8FD9\u51E0\u4E2A\u5DE5\u5177\uFF09\u3002</p></li></ul><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="powershell"><ol><li><div class="code-word"><span class="hljs-comment">#\u4E0B\u8F7D\u547D\u4EE4</span>\r
</div></li><li><div class="code-word">git clone https://github.com/wg/wrk.git \r
</div></li><li><div class="code-word"><span class="hljs-comment">#\u5207\u6362\u8DEF\u5F84\u5230wrk\u76EE\u5F55\u4E0B</span>\r
</div></li><li><div class="code-word"><span class="hljs-built_in">cd</span> wrk  \r
</div></li><li><div class="code-word"><span class="hljs-comment">#\u4F7F\u7528make\u547D\u4EE4\u7F16\u8BD1\u73AF\u5883</span>\r
</div></li><li><div class="code-word"> \r
</div></li><li><div class="code-word">make \r
</div></li></ol></code></pre></div><ul data-nodeid="191143"><li data-nodeid="191144"><p data-nodeid="191145">\u5728<strong data-nodeid="191696">Windows</strong>\u4E0A\u5C31\u975E\u5E38\u9057\u61BE\u4E86\uFF0C\u56E0\u4E3A\u8FD9\u4E2A\u5DE5\u5177\u4E0D\u652F\u6301 Windows\u3002\u4F46\u5982\u679C\u4F60\u662F Windows 10\uFF0C\u53EF\u4EE5\u5207\u6362\u5230 Ubuntu \u5B50\u7CFB\u7EDF\u7684\u65B9\u5F0F\u6765\u5B89\u88C5\uFF0C\u6216\u8005\u5728 Windows \u4E0A\u5B89\u88C5 Linux \u865A\u62DF\u673A\u4E5F\u662F\u53EF\u4EE5\u7684\u3002</p></li></ul><p data-nodeid="191146">\u6210\u529F\u5B89\u88C5\u540E\uFF0C\u4F60\u53EF\u4EE5\u5728\u547D\u4EE4\u884C\u4F7F\u7528\u2026\u2026\u547D\u4EE4\u67E5\u770B\u5177\u4F53\u7684\u53C2\u6570\u8BF4\u660E\u548C\u4ECB\u7ECD\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="powershell"><ol><li><div class="code-word">wrk\r
</div></li></ol></code></pre></div><p data-nodeid="191148">\u8FD9\u4E00\u8BB2\u56E0\u4E3A\u9700\u8981\u8FDB\u884C\u5E76\u53D1\u8BF7\u6C42\u7684\u9A8C\u8BC1\uFF0C\u6240\u4EE5\u6211\u4EEC\u4F1A\u4F7F\u7528\u4E0B\u9762\u7684\u538B\u6D4B\u547D\u4EE4\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="powershell"><ol><li><div class="code-word">wrk <span class="hljs-literal">-t4</span> <span class="hljs-literal">-c300</span> <span class="hljs-literal">-d20s</span> https://www.baidu.com/\r
</div></li></ol></code></pre></div><p data-nodeid="191150">\u5176\u53C2\u6570\u8BF4\u660E\u5982\u4E0B\uFF1A</p><ul data-nodeid="191151"><li data-nodeid="191152"><p data-nodeid="191153">-t \u4EE3\u8868\u7684\u662F\u542F\u52A8 4 \u4E2A\u7EBF\u7A0B\uFF1B</p></li><li data-nodeid="191154"><p data-nodeid="191155">-c \u4EE3\u8868\u7684\u662F\u5E76\u53D1\u6570\uFF0C300 \u4E2A\u5E76\u53D1\u8BF7\u6C42\uFF1B</p></li><li data-nodeid="191156"><p data-nodeid="191157">-d \u4EE3\u8868\u7684\u662F\u6301\u7EED\u65F6\u957F\uFF0C20s \u5C31\u662F 20 \u79D2\u3002</p></li></ul><p data-nodeid="191158">\u6211\u4EEC\u8FD0\u884C\u4E0A\u9762\u7684\u547D\u4EE4\u540E\uFF0C\u4F1A\u6709\u76F8\u5E94\u7684\u538B\u6D4B\u7ED3\u679C\uFF0C\u5982\u4E0B\u6240\u793A\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="powershell"><ol><li><div class="code-word">Running <span class="hljs-number">20</span>s test <span class="hljs-selector-tag">@</span> https://www.baidu.com/\r
</div></li><li><div class="code-word">\xA0 <span class="hljs-number">10</span> threads and <span class="hljs-number">300</span> connections\r
</div></li><li><div class="code-word">\xA0 Thread Stats \xA0 Avg\xA0 \xA0 \xA0 Stdev \xA0 \xA0 Max \xA0 +/- Stdev\r
</div></li><li><div class="code-word">\xA0 \xA0 Latency \xA0 <span class="hljs-number">789.93</span>ms\xA0 <span class="hljs-number">393.84</span>ms \xA0 <span class="hljs-number">2.00</span>s\xA0 \xA0 <span class="hljs-number">76.57</span>%\r
</div></li><li><div class="code-word">\xA0 \xA0 Req/Sec\xA0 \xA0 <span class="hljs-number">14.33</span> \xA0 \xA0 <span class="hljs-number">10.17</span>\xA0 \xA0 <span class="hljs-number">59.00</span> \xA0 \xA0 <span class="hljs-number">72.31</span>%\r
</div></li><li><div class="code-word">\xA0 <span class="hljs-number">2252</span> requests <span class="hljs-keyword">in</span> <span class="hljs-number">20.10</span>s, <span class="hljs-number">34.49</span>MB read\r
</div></li><li><div class="code-word">\xA0 Socket errors: connect <span class="hljs-number">60</span>, read <span class="hljs-number">0</span>, <span class="hljs-built_in">write</span> <span class="hljs-number">0</span>, timeout <span class="hljs-number">481</span>\r
</div></li><li><div class="code-word">Requests/sec:\xA0 \xA0 <span class="hljs-number">112.05</span>\r
</div></li><li><div class="code-word">Transfer/sec:\xA0 \xA0 \xA0 <span class="hljs-number">1.72</span>MB\r
</div></li></ol></code></pre></div><p data-nodeid="191160">\u4E0A\u9762\u7684\u7ED3\u679C\uFF0C\u6211\u4EEC\u6838\u5FC3\u5E94\u8BE5\u5173\u6CE8\u7684\u662F Requests/sec \u4E3A QPS\uFF0C\u5176\u6B21\u4E5F\u9700\u8981\u4E86\u89E3\u5E73\u5747\u8017\u65F6\u7684\u60C5\u51B5\uFF0C\u4E5F\u5C31\u662F\u4E0A\u9762\u7684 Avg 789.93ms\uFF0C\u4EE5\u53CA\u5931\u8D25\u8D85\u65F6\u7684\u60C5\u51B5\uFF0C\u5373\u4E0A\u9762 socket errors \u7684 timeout 481\u3002</p><h4 data-nodeid="191161">Chrome \u5206\u6790\u5DE5\u5177 JavaScript Profiler</h4><p data-nodeid="191162">\u5728\u538B\u6D4B\u4E0B\uFF0C\u5982\u679C\u53D1\u73B0\u8BF7\u6C42 QPS \u975E\u5E38\u4F4E\u3001\u5E73\u5747\u8017\u65F6\u975E\u5E38\u957F\uFF0C\u6216\u8005\u5931\u8D25\u7387\u975E\u5E38\u9AD8\u7684\u8BDD\uFF0C\u8FD9\u65F6\u5C31\u9700\u8981\u5C06 CPU \u4FE1\u606F\u8FDB\u884C\u4FDD\u5B58\uFF0C\u7136\u540E\u7528 Chrome \u7684 JavaScript Profiler \u5DE5\u5177\u6765\u8FDB\u884C\u5206\u6790\u3002</p><p data-nodeid="191163">\u65B9\u6CD5\u4E5F\u5F88\u7B80\u5355\uFF0C\u7528 Chrome \u7684\u5F00\u53D1\u8005\u5DE5\u5177 More-tools \u2192 JavaScript Profiler \u2192 Load\uFF0C\u8BFB\u53D6 CPU Profile\uFF0C\u67E5\u770B\u706B\u7130\u56FE\uFF08\u5982\u56FE 1 \u6240\u793A\uFF09\u3002</p><p data-nodeid="199540" class=""><img src="https://s0.lgstatic.com/i/image6/M00/34/08/CioPOWBwD02Ab_ffAAK5Evk7rNM190.png" alt="Drawing 0.png" data-nodeid="199544"></p><div data-nodeid="199541"><p style="text-align:center;">\u56FE 1 Chrome \u6253\u5F00 JavaScript Profiler \u6307\u5F15\u56FE</p></div><p data-nodeid="191166">\u8981\u4F7F\u7528\u8FD9\u4E2A\u529F\u80FD\uFF0C\u9700\u8981\u5728 Node.js \u4E2D\u5BF9 CPU \u8FDB\u884C\u91C7\u96C6\uFF0C\u91C7\u96C6\u7684\u65B9\u5F0F\u9700\u8981\u4F7F\u7528 v8-profiler \u8FD9\u4E2A\u5E93\uFF08\u5982\u679C\u4F60\u7684 Node.js \u7248\u672C\u5927\u4E8E 10\uFF0C\u5219\u9700\u8981\u4F7F\u7528 v8-profiler-next \u8FD9\u4E2A\u5E93\uFF09\uFF0C\u5728\u4E0A\u4E00\u8BB2\u4E2D\u5DF2\u7ECF\u5E94\u7528\u8FC7\u8BE5\u5DE5\u5177\u5206\u6790\u8FC7\u5185\u5B58\u6CC4\u6F0F\u95EE\u9898\u3002</p><h4 data-nodeid="191167">\u7B80\u5355 Demo \u6F14\u793A</h4><p data-nodeid="191168">\u4E3A\u4E86\u6F14\u793A\u8FD9\u4E2A\u5206\u6790\u65B9\u5F0F\uFF0C\u6211\u4EEC\u5199\u4E00\u4E2A\u6700\u7B80\u5355\u7684\u6D4B\u8BD5\u4EE3\u7801\uFF0C\u5982\u4E0B\u6240\u793A\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#39;http&#39;</span>);\r
</div></li><li><div class="code-word"><span class="hljs-comment">// \u5F15\u5165 v8-profiler \u5E93\uFF0C\u53EF\u4EE5\u4F5C\u4E3A\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u6765\u5B9E\u73B0</span>\r
</div></li><li><div class="code-word"><span class="hljs-keyword">const</span> v8Profiler = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#39;./lib/v8_profiler&#39;</span>);\r
</div></li><li><div class="code-word"><span class="hljs-comment">/**\r
</span></div></li><li><div class="code-word"> * \r
</div></li><li><div class="code-word"> * \u521B\u5EFA http \u670D\u52A1\uFF0C\u7B80\u5355\u8FD4\u56DE\r
</div></li><li><div class="code-word"> */\r
</div></li><li><div class="code-word"><span class="hljs-keyword">const</span> server = http.createServer(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {\r
</div></li><li><div class="code-word">    res.write(<span class="hljs-string">&#39;hello world&#39;</span>);\r
</div></li><li><div class="code-word">    res.end();\r
</div></li><li><div class="code-word">});\r
</div></li><li><div class="code-word"><span class="hljs-comment">/**\r
</span></div></li><li><div class="code-word"> * \r
</div></li><li><div class="code-word"> * \u542F\u52A8\u670D\u52A1\uFF0C\u5E76\u5F00\u59CB\u6267\u884C v8 profiler \u7684\u91C7\u96C6\u5DE5\u4F5C\r
</div></li><li><div class="code-word"> */\r
</div></li><li><div class="code-word">server.listen(<span class="hljs-number">3000</span>, () =&gt; {\r
</div></li><li><div class="code-word">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#39;server start http://127.0.0.1:3000&#39;</span>);\r
</div></li><li><div class="code-word">    v8Profiler.start();\r
</div></li><li><div class="code-word">});\r
</div></li></ol></code></pre></div><p data-nodeid="191170">\u5728\u4E0A\u9762\u4EE3\u7801\u4E2D\u7684\u7B2C\u4E8C\u884C\uFF0C\u6211\u4EEC\u5F15\u5165\u4E86\u4E00\u4E2A\u81EA\u8EAB\u5199\u7684 v8-profiler \u5E93\uFF0C\u63A5\u4E0B\u6765\u770B\u770B\u8FD9\u4E2A\u5E93\u7684\u903B\u8F91\u3002</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word"><span class="hljs-meta">&#39;use strict&#39;</span>;\r
</div></li><li><div class="code-word"><span class="hljs-keyword">const</span> v8Profiler = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#39;v8-profiler-next&#39;</span>);\r
</div></li><li><div class="code-word"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#39;fs&#39;</span>);\r
</div></li><li><div class="code-word"><span class="hljs-comment">// \u8BBE\u7F6E\u91C7\u96C6\u6570\u636E\u4FDD\u5B58\u7684\u6587\u4EF6\u540D</span>\r
</div></li><li><div class="code-word"><span class="hljs-keyword">const</span> title = <span class="hljs-string">&#39;example&#39;</span>;\r
</div></li><li><div class="code-word"><span class="hljs-built_in">module</span>.exports = {\r
</div></li><li><div class="code-word">    <span class="hljs-string">&#39;start&#39;</span> : <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {\r
</div></li><li><div class="code-word">        <span class="hljs-comment">// \u542F\u52A8\u91C7\u96C6\uFF0C\u5982\u679C\u9700\u8981\u5B9A\u65F6\u91C7\u96C6\uFF0C\u53EF\u4EE5\u5C06 title \u8BBE\u7F6E\u4E3A\u4E00\u4E2A\u52A8\u6001\u7684\u6839\u636E\u65F6\u95F4\u53D8\u5316\u7684\u503C</span>\r
</div></li><li><div class="code-word">        v8Profiler.startProfiling(title, <span class="hljs-literal">true</span>);\r
</div></li><li><div class="code-word">        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> { <span class="hljs-comment">// 30 \u79D2\u540E\u91C7\u96C6\u5E76\u5BFC\u51FA</span>\r
</div></li><li><div class="code-word">          <span class="hljs-keyword">const</span> profile = v8Profiler.stopProfiling(title);\r
</div></li><li><div class="code-word">          profile.export(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error, result</span>) </span>{ <span class="hljs-comment">// \u5C06\u5185\u5BB9\u5199\u5165\u6307\u5B9A\u6587\u4EF6</span>\r
</div></li><li><div class="code-word">            fs.writeFileSync(<span class="hljs-string">\`./cpu_profiler/<span class="hljs-subst">\${title}</span>.cpuprofile\`</span>, result);\r
</div></li><li><div class="code-word">            profile.delete();\r
</div></li><li><div class="code-word">          });\r
</div></li><li><div class="code-word">        }, <span class="hljs-number">30</span> * <span class="hljs-number">1000</span>);\r
</div></li><li><div class="code-word">    }\r
</div></li><li><div class="code-word">};\r
</div></li></ol></code></pre></div><p data-nodeid="191172"><strong data-nodeid="191720">\u4E0A\u9762\u4EE3\u7801\u4E2D\u7684 start \u65B9\u6CD5\uFF0C\u5C31\u662F\u6838\u5FC3\u7684\u91C7\u96C6\u4EE3\u7801</strong>\u3002v8-Profiler \u5F00\u59CB\u91C7\u96C6\uFF0C\u4F7F\u7528 title \u4F5C\u4E3A\u552F\u4E00\u6807\u793A\uFF0C\u5728 30 \u79D2\u540E\uFF0C\u505C\u6B62\u8FD9\u4E2A title \u7684\u91C7\u96C6\uFF0C\u5E76\u83B7\u53D6\u6570\u636E\u4FDD\u5B58\u5728\u6587\u4EF6\u4E2D\u3002</p><p data-nodeid="191173">\u4E3A\u4E86\u9A8C\u8BC1\u6548\u679C\uFF0C\u4F60\u53EF\u4EE5\u6839\u636E\u6211\u4EEC\u4E0B\u9762\u7684\u6B65\u9AA4\u6765\u8FDB\u884C\u5206\u6790\uFF08\u4EE3\u7801\u6E90\u7801\u4FDD\u5B58\u5728<a href="https://github.com/love-flutter/nodejs-column?fileGuid=xxQTRXtVcqtHK6j8" data-nodeid="191724">GitHub</a>\u4E2D\uFF0C\u81EA\u884C\u4E0B\u8F7D\u540E\uFF0C\u53EF\u6309\u7167\u4E0B\u9762\u6B65\u9AA4\u6267\u884C\uFF09\u3002</p><p data-nodeid="191174">\uFF081\uFF09\u6253\u5F00\u9879\u76EE\uFF0C\u8FDB\u5165\u9879\u76EE\u6839\u76EE\u5F55\uFF0C\u6267\u884C\u547D\u4EE4\u542F\u52A8\u670D\u52A1\u3002</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="java"><ol><li><div class="code-word">npm run test\r
</div></li></ol></code></pre></div><p data-nodeid="191176">\uFF082\uFF09\u6253\u5F00\u53E6\u5916\u4E00\u4E2A\u547D\u4EE4\u7A97\u53E3\uFF0C\u5F00\u59CB\u6267\u884C\u538B\u6D4B\u7A0B\u5E8F\u3002</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="java"><ol><li><div class="code-word">wrk -t2 -c300 -d20s http:<span class="hljs-comment">//127.0.0.1:3000/</span>\r
</div></li></ol></code></pre></div><p data-nodeid="191178">\uFF083\uFF09\u5927\u6982 30 \u79D2\u540E\uFF0C\u9879\u76EE\u76EE\u5F55\u4E0B\u7684 cpu_profiler \u6587\u4EF6\u5939\u4E0B\u4F1A\u751F\u6210 example.cpuprofile \u6587\u4EF6\u3002</p><p data-nodeid="191179">\uFF084\uFF09\u6253\u5F00 Chrome \u5DE5\u5177\u4E2D\u7684 JavaScript Profiler\uFF0C\u7136\u540E load \u521A\u624D\u9879\u76EE\u76EE\u5F55\u4E0B\u7684 cpu_profiler/example.cpuprofile \u6587\u4EF6\uFF0C\u5C31\u53EF\u4EE5\u770B\u5230\u5982\u56FE 2 \u6240\u793A\u7684\u7ED3\u679C\u3002</p><p data-nodeid="204356" class=""><img src="https://s0.lgstatic.com/i/image6/M01/33/FF/Cgp9HWBwD1yAaayGAAO16nRrzQQ497.png" alt="Drawing 1.png" data-nodeid="204360"></p><div data-nodeid="204357"><p style="text-align:center;">\u56FE 2 cpuprofile \u6F14\u793A\u7ED3\u679C</p></div><p data-nodeid="191182">\u4ECE\u4E0A\u9762\u7684\u7ED3\u679C\u53EF\u4EE5\u770B\u5230\u76F8\u5E94\u7684\u5355\u4E2A\u6267\u884C\u65F6\u95F4\u548C\u603B\u7684\u8017\u65F6\u3002\u5982\u679C\u6027\u80FD\u8F83\u6162\uFF0C\u4F60\u53EF\u4EE5\u53C2\u7167\u6807\u51C6\u7684\u7ED3\u679C\u6765\u8FDB\u884C\u5206\u6790\uFF0C\u6216\u8005\u5BF9\u6BD4\u4E00\u4E2A\u6027\u80FD\u8F83\u597D\u3001\u4E00\u4E2A\u6027\u80FD\u8F83\u5DEE\u7684\u6267\u884C\u7ED3\u679C\u3002\u4E3A\u4E86\u8BA9\u4F60\u66F4\u6E05\u6670\u5730\u4E86\u89E3\u8FD9\u4E9B\uFF0C\u4E0B\u9762\u6211\u5C06\u4ECE\u5B9E\u8DF5\u6765\u8FDB\u884C\u5206\u6790\u3002</p><h3 data-nodeid="191183">\u5B9E\u8DF5\u5206\u6790</h3><p data-nodeid="191184">\u5728\u5206\u6790\u4EFB\u4F55\u6570\u636E\u4E4B\u524D\uFF0C\u9996\u5148\u5FC5\u987B\u6709\u4E00\u4E2A\u6807\u51C6\u7684\u6570\u636E\u8FDB\u884C\u6BD4\u8F83\uFF0C\u5982\u679C\u4F60\u7528\u7684\u662F Express\u3001Eggjs \u7B49\u6846\u67B6\uFF0C\u9700\u8981\u505A\u4E00\u4E2A\u5B8C\u5168\u7A7A\u8F6C\u7684\u6570\u636E\u4F5C\u4E3A\u6807\u51C6\u5206\u6790\u6570\u636E\u3002\u5728\u672C\u8BB2\uFF0C\u7531\u4E8E\u6211\u4EEC\u6CA1\u6709\u7528\u4EFB\u4F55\u6846\u67B6\uFF0C\u6240\u4EE5\u9700\u8981\u8BBE\u8BA1\u4E00\u4E2A\u5B8C\u5168\u7A7A\u8F6C\u7684 HTTP \u670D\u52A1\u6765\u4F5C\u4E3A\u6807\u51C6\u7684\u5206\u6790\u6570\u636E\u3002</p><h4 data-nodeid="191185">\u6807\u51C6\u6570\u636E</h4><p data-nodeid="191186">\u8FD9\u91CC\u6211\u4EEC\u8FD8\u662F\u7528\u4E0A\u9762\u201C\u7B80\u5355 Demo \u6F14\u793A\u201D\u4E2D\u7684\u4EE3\u7801\uFF0C\u7136\u540E\u901A\u8FC7 WRK \u4E0B\u9762\u7684\u538B\u6D4B\u547D\u4EE4\u6765\u538B\u6D4B\uFF0C\u770B\u4E0B\u5177\u4F53\u7684\u6570\u636E\u60C5\u51B5\u3002</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="java"><ol><li><div class="code-word">wrk -t2 -c300 -d20s http:<span class="hljs-comment">//127.0.0.1:3000/</span>\r
</div></li></ol></code></pre></div><p data-nodeid="191188">\u538B\u6D4B\u5F97\u5230\u7684\u7ED3\u679C\u5982\u8868 1 \u6240\u793A\u3002</p><p data-nodeid="209047"><img src="https://s0.lgstatic.com/i/image6/M00/34/08/CioPOWBwD2aAAtjKAABBXwAaJE8675.png" alt="Drawing 2.png" data-nodeid="209050"></p><p data-nodeid="191219">\u6709\u4E86\u8FD9\u4EFD\u6570\u636E\u540E\uFF0C\u6211\u4EEC\u518D\u6765\u9010\u4E2A\u5206\u6790\u4EE5\u4E0B\u95EE\u9898\u3002</p><h4 data-nodeid="191220">CPU \u8BA1\u7B97\u8017\u65F6</h4><p data-nodeid="191221">\u4E3A\u4E86\u9A8C\u8BC1\u6548\u679C\uFF0C\u8FD9\u91CC\u6211\u4EEC\u5199\u4E00\u4E2A CPU \u8BA1\u7B97\u8017\u65F6\u7684\u903B\u8F91\uFF0C\u7136\u540E\u7EE7\u7EED\u538B\u6D4B\u3002\u8FD9\u70B9\u5728\u6A21\u5757\u4E00\u7684<a href="https://kaiwu.lagou.com/course/courseInfo.htm?courseId=694#/detail/pc?id=6788&amp;fileGuid=xxQTRXtVcqtHK6j8" data-nodeid="191788">\u300A06 | \u54EA\u4E9B\u56E0\u7D20\u4F1A\u5F71\u54CD Node.js \u6027\u80FD\uFF1F\u300B</a>\u5DF2\u7ECF\u6709\u4E00\u4E9B\u4F8B\u5B50\uFF0C\u6211\u4EEC\u62FF\u4E00\u4E2A\u51FA\u6765\u5C1D\u8BD5\u4E00\u4E0B\uFF0C\u6BD4\u5982 MD5 \u8BA1\u7B97\u7684\u903B\u8F91\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word">crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#39;crypto&#39;</span>);\r
</div></li><li><div class="code-word"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">content</span>) =&gt;</span> {\r
</div></li><li><div class="code-word">    <span class="hljs-keyword">return</span> crypto.createHash(<span class="hljs-string">&#39;md5&#39;</span>).update(content).digest(<span class="hljs-string">&quot;hex&quot;</span>)\r
</div></li><li><div class="code-word">}\r
</div></li></ol></code></pre></div><p data-nodeid="191223">\u6838\u5FC3\u903B\u8F91\u5C31\u662F\u5E94\u7528 crypto \u6765\u751F\u6210 MD5 \u52A0\u5BC6\u6570\u636E\uFF0C\u4E3A\u4E86\u6548\u679C\u66F4\u597D\uFF0C\u6211\u4EEC\u5728\u5165\u53E3\u6587\u4EF6 index.js \u4E2D\u591A\u8C03\u7528\u51E0\u6B21\uFF0C\u8FD9\u91CC\u53EA\u4FEE\u6539 server \u4E2D\u7684\u4EE3\u7801\u903B\u8F91\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word"><span class="hljs-keyword">const</span> server = http.createServer(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {\r
</div></li><li><div class="code-word">    <span class="hljs-comment">// \u8BBE\u7F6E\u8FD4\u56DE\u7684\u5B57\u7B26\u4E32</span>\r
</div></li><li><div class="code-word">    <span class="hljs-keyword">let</span> ret;\r
</div></li><li><div class="code-word">    <span class="hljs-comment">// \u52A0\u5BC6\u4E00\u7EC4\u6570\u636E</span>\r
</div></li><li><div class="code-word">    <span class="hljs-keyword">const</span> md5List = [<span class="hljs-string">&#39;hello&#39;</span>, <span class="hljs-string">&#39;Node.js&#39;</span>, <span class="hljs-string">&#39;lagou&#39;</span>, <span class="hljs-string">&#39;is&#39;</span>, <span class="hljs-string">&#39;great&#39;</span>];\r
</div></li><li><div class="code-word">    md5List.forEach( <span class="hljs-function">(<span class="hljs-params">str</span>)=&gt;</span> {\r
</div></li><li><div class="code-word">        <span class="hljs-keyword">if</span>(ret){\r
</div></li><li><div class="code-word">            ret = <span class="hljs-string">\`<span class="hljs-subst">\${ret}</span> <span class="hljs-subst">\${getMd5(str)}</span>\`</span>;\r
</div></li><li><div class="code-word">        } <span class="hljs-keyword">else</span> {\r
</div></li><li><div class="code-word">            ret = getMd5(str)\r
</div></li><li><div class="code-word">        }\r
</div></li><li><div class="code-word">    });\r
</div></li><li><div class="code-word">    res.write(ret);\r
</div></li><li><div class="code-word">    res.end();\r
</div></li><li><div class="code-word">});\r
</div></li></ol></code></pre></div><p data-nodeid="191225">\u4FEE\u6539\u5B8C\u6210\u540E\uFF0C\u6211\u4EEC\u518D\u6309\u7167\u7B80\u5355 Demo \u4E2D\u7684\u56DB\u4E2A\u6B65\u9AA4\u538B\u6D4B\u6570\u636E\u5373\u53EF\uFF1A</p><ul data-nodeid="191226"><li data-nodeid="191227"><p data-nodeid="191228">\u542F\u52A8\u670D\u52A1</p></li><li data-nodeid="191229"><p data-nodeid="191230">\u5F00\u59CB\u538B\u6D4B</p></li><li data-nodeid="191231"><p data-nodeid="191232">\u7B49\u5F85 CPU \u91C7\u96C6</p></li><li data-nodeid="191233"><p data-nodeid="191234">\u5206\u6790\u538B\u6D4B\u6570\u636E</p></li></ul><p data-nodeid="191235">\u63A5\u4E0B\u6765\u6211\u4EEC\u770B\u4E0B\u538B\u6D4B\u540E\u7684\u6570\u636E\uFF0C\u5982\u8868 2 \u6240\u793A\u3002</p><p data-nodeid="211325" class=""><img src="https://s0.lgstatic.com/i/image6/M00/34/08/CioPOWBwD3SAIEtvAABS4dW-YPo314.png" alt="Drawing 3.png" data-nodeid="211328"></p><p data-nodeid="191274">\u8FD9\u4E00\u5BF9\u6BD4\u53EF\u4EE5\u975E\u5E38\u6E05\u6670\u5730\u770B\u5230\uFF0C\u76F8\u5BF9\u4E8E\u6807\u51C6\u670D\u52A1\uFF0CCPU \u8017\u65F6\u670D\u52A1\u5728\u5404\u65B9\u9762\uFF08\u5E73\u5747\u8017\u65F6\u3001\u6700\u4F4E\u8017\u65F6\u3001\u6700\u5927\u8017\u65F6\u4EE5\u53CA\u5931\u8D25\u7387\uFF09\u90FD\u5DEE\u5F88\u591A\uFF0C\u5728\u6027\u80FD\u4E0A\u4E24\u8005\u662F\u6709\u6BD4\u8F83\u5927\u7684\u843D\u5DEE\u7684\uFF0C\u5982\u679C\u6211\u4EEC\u4E0D\u77E5\u9053\u662F\u56E0\u4E3A MD5 \u5F71\u54CD\u5230 CPU \u8BA1\u7B97\u5BFC\u81F4\u7684\uFF0C\u90A3\u4E48\u5C31\u9700\u8981\u5206\u6790 CPU \u8017\u65F6\u7684\u60C5\u51B5\u4E86\u3002</p><p data-nodeid="191275">\u63A5\u4E0B\u6765\u6211\u4EEC\u6253\u5F00 Chrome JavaScript Profiler \u5DE5\u5177\uFF0C\u53EF\u4EE5\u770B\u5230\u5982\u56FE 3 \u6240\u793A\u7684\u7ED3\u679C\u3002</p><p data-nodeid="215563"><img src="https://s0.lgstatic.com/i/image6/M00/34/08/CioPOWBwD3uADtMhAAMNNH1bIOY973.png" alt="Drawing 4.png" data-nodeid="215567"></p><div data-nodeid="215564" class=""><p style="text-align:center;">\u56FE 3 CPU \u538B\u6D4B CPU \u8017\u65F6\u5206\u6790</p></div><p data-nodeid="191278">\u51E0\u4E2A\u8017\u65F6\u8F83\u957F\u7684\u51FD\u6570\uFF0C\u4F8B\u5982 digest\u3001Hash \u4EE5\u53CA update \u7B49\uFF0C\u90FD\u662F\u5728 MD5 \u8BA1\u7B97\u4E2D\u7684\u903B\u8F91\uFF0C\u56E0\u6B64\u53EF\u4EE5\u975E\u5E38\u6E05\u6670\u5730\u4E86\u89E3\u5230\uFF0C\u5728 MD5 \u8BA1\u7B97\u65B9\u9762\u4F1A\u5BF9 Node.js \u7684\u670D\u52A1\u6709\u4E00\u4E2A\u6BD4\u8F83\u5927\u7684\u6027\u80FD\u5F71\u54CD\uFF0C\u56E0\u6B64\u5728\u5F00\u53D1\u65F6\u5C3D\u91CF\u51CF\u5C11\u6216\u8005\u907F\u514D\u8FD9\u79CD\u7C7B\u4F3C\u7684\u8BA1\u7B97\u670D\u52A1\u3002</p><h4 data-nodeid="191279">\u7F51\u7EDC I/O</h4><p data-nodeid="191280">\u4E3A\u4E86\u6F14\u793A\u6548\u679C\uFF0C\u6211\u4EEC<strong data-nodeid="191858">\u5148\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u670D\u52A1</strong>\uFF0C\u8FD9\u4E2A\u670D\u52A1\u5728\u539F\u6765\u7684\u201C\u7B80\u5355 Demo \u6F14\u793A\u201D\u57FA\u7840\u4E0A\u589E\u52A0\u4E86\u4E00\u4E2A\u5EF6\u8FDF\u8FD4\u56DE\u7684\u6548\u679C\uFF0C\u5177\u4F53\u4EE3\u7801\u5728 api_server \u6587\u4EF6\u9879\u76EE\u4E2D\uFF0C\u6838\u5FC3\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#39;http&#39;</span>);\r
</div></li><li><div class="code-word"><span class="hljs-comment">/**\r
</span></div></li><li><div class="code-word"> * \r
</div></li><li><div class="code-word"> * \u521B\u5EFA http \u670D\u52A1\uFF0C\u7B80\u5355\u8FD4\u56DE\r
</div></li><li><div class="code-word"> */\r
</div></li><li><div class="code-word"><span class="hljs-keyword">const</span> server = http.createServer(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {\r
</div></li><li><div class="code-word">    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> { <span class="hljs-comment">// \u5EF6\u8FDF 1 \u79D2\u8FD4\u56DE</span>\r
</div></li><li><div class="code-word">        res.write(<span class="hljs-string">&#39;this is api result&#39;</span>);\r
</div></li><li><div class="code-word">        res.end();\r
</div></li><li><div class="code-word">    }, <span class="hljs-number">1</span> * <span class="hljs-number">1000</span>);\r
</div></li><li><div class="code-word">});\r
</div></li><li><div class="code-word"><span class="hljs-comment">/**\r
</span></div></li><li><div class="code-word"> * \r
</div></li><li><div class="code-word"> * \u542F\u52A8\u670D\u52A1\uFF0C\u5E76\u5F00\u59CB\u6267\u884C v8 profiler \u7684\u91C7\u96C6\u5DE5\u4F5C\r
</div></li><li><div class="code-word"> */\r
</div></li><li><div class="code-word">server.listen(<span class="hljs-number">4000</span>, () =&gt; {\r
</div></li><li><div class="code-word">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#39;server start http://127.0.0.1:4000&#39;</span>);\r
</div></li><li><div class="code-word">});\r
</div></li></ol></code></pre></div><p data-nodeid="191282">\u6838\u5FC3\u4EE3\u7801\u662F\u5728 setTimeout \u5EF6\u8FDF\u8FD4\u56DE\uFF0C\u5176\u6B21\u4FEE\u6539\u4E86\u4EE5\u4E0B\u76D1\u542C\u7AEF\u53E3\uFF0C\u4ECE 3000 \u4FEE\u6539\u4E3A 4000\u3002</p><p data-nodeid="191283"><strong data-nodeid="191868">\u63A5\u4E0B\u6765\u6211\u4EEC\u521B\u5EFA\u4E00\u4E2A network_io</strong>\uFF0C\u5B9E\u73B0\u8C03\u7528 http://127.0.0.1:4000 \u8FD9\u4E2A\u670D\u52A1\uFF0C\u4ECE\u800C\u5B9E\u73B0\u7F51\u7EDC I/O \u64CD\u4F5C\u3002\u9996\u5148\u8FD8\u662F\u5B9E\u73B0\u4E00\u4E2A call_api \u7684\u670D\u52A1\uFF0C\u8BE5\u670D\u52A1\u4F1A\u5E94\u7528\u5230 request \u8FD9\u4E2A npm \u5E93\uFF08\u540E\u7EED\u8FD9\u4E2A\u5E93\u4E0D\u4F1A\u7EF4\u62A4\u4E86\uFF0C\u6682\u65F6\u8FD8\u6CA1\u6709\u66FF\u4EE3\u65B9\u6848\uFF0C\u9664\u975E\u81EA\u5DF1\u624B\u52A8\u5B9E\u73B0\uFF09\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word"><span class="hljs-comment">// \u5F15\u5165 request \u5E93\uFF0C\u9700\u8981\u5728 package.json \u4E2D\u7533\u660E\uFF0C\u5E76\u4E14 npm install</span>\r
</div></li><li><div class="code-word"><span class="hljs-keyword">const</span> request = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#39;request&#39;</span>);\r
</div></li><li><div class="code-word"><span class="hljs-comment">/**\r
</span></div></li><li><div class="code-word"> * \r
</div></li><li><div class="code-word"> * request \u8C03\u7528\u5916\u90E8 api\r
</div></li><li><div class="code-word"> * @param {*} apiLink string\r
</div></li><li><div class="code-word"> * @param {*} callback funtion\r
</div></li><li><div class="code-word"> * \r
</div></li><li><div class="code-word"> */\r
</div></li><li><div class="code-word"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">apiLink, callback</span>) =&gt;</span> {\r
</div></li><li><div class="code-word">    request(apiLink, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error, response, body</span>) </span>{\r
</div></li><li><div class="code-word">        <span class="hljs-keyword">if</span>(error) {\r
</div></li><li><div class="code-word">            callback(<span class="hljs-literal">false</span>);\r
</div></li><li><div class="code-word">        } <span class="hljs-keyword">else</span> {\r
</div></li><li><div class="code-word">            callback(body);\r
</div></li><li><div class="code-word">        }\r
</div></li><li><div class="code-word">    });\r
</div></li><li><div class="code-word">}\r
</div></li></ol></code></pre></div><p data-nodeid="191285">\u8FD9\u90E8\u5206\u4EE3\u7801\u4E3B\u8981\u662F\u5E94\u7528 request \u6A21\u5757\u8C03\u7528 apiLink \u670D\u52A1\uFF0C\u5E76\u83B7\u53D6\u6267\u884C\u7ED3\u679C\u3002\u901A\u8FC7\u56DE\u8C03\u7684\u65B9\u5F0F\u8FD4\u56DE\u5177\u4F53\u7684\u6570\u636E\uFF0C\u4E5F\u5C31\u662F\u4E0A\u9762\u7684\u53C2\u6570 callback\u3002</p><p data-nodeid="191286">\u6700\u540E\u6211\u4EEC\u518D\u6765\u770B\u4E0B index.js \u4E2D\u7684\u6838\u5FC3\u90E8\u5206 server \u7684\u4FEE\u6539\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word"><span class="hljs-comment">/**\r
</span></div></li><li><div class="code-word"> * \r
</div></li><li><div class="code-word"> * \u521B\u5EFA http \u670D\u52A1\uFF0C\u7B80\u5355\u8FD4\u56DE\r
</div></li><li><div class="code-word"> */\r
</div></li><li><div class="code-word"><span class="hljs-keyword">const</span> server = http.createServer(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {\r
</div></li><li><div class="code-word">    callApi(<span class="hljs-string">&#39;http://127.0.0.1:4000&#39;</span>, (ret) =&gt; { <span class="hljs-comment">// \u8C03\u7528 4000 \u670D\u52A1\uFF0C\u5E76\u663E\u793A\u8FD4\u56DE\u7ED3\u679C</span>\r
</div></li><li><div class="code-word">        <span class="hljs-keyword">if</span>(ret) {\r
</div></li><li><div class="code-word">            res.write(ret);\r
</div></li><li><div class="code-word">        } <span class="hljs-keyword">else</span> {\r
</div></li><li><div class="code-word">            res.write(<span class="hljs-string">&#39;call api server error&#39;</span>);\r
</div></li><li><div class="code-word">        }\r
</div></li><li><div class="code-word">        res.end();\r
</div></li><li><div class="code-word">    });\r
</div></li><li><div class="code-word">});\r
</div></li></ol></code></pre></div><p data-nodeid="191288">\u63A5\u4E0B\u6765\u5C31\u542F\u52A8\u4E24\u4E2A\u670D\u52A1\uFF0C\u5206\u522B\u6253\u5F00\u5730\u5740\uFF1A</p><ul data-nodeid="191289"><li data-nodeid="191290"><p data-nodeid="191291"><a href="http://127.0.0.1:4000?fileGuid=xxQTRXtVcqtHK6j8" data-nodeid="191874">http://127.0.0.1:4000</a></p></li><li data-nodeid="191292"><p data-nodeid="191293"><a href="http://127.0.0.1:3000?fileGuid=xxQTRXtVcqtHK6j8" data-nodeid="191877">http://127.0.0.1:3000</a></p></li></ul><p data-nodeid="191294">\u770B\u4E0B\u662F\u5426\u6B63\u5E38\u54CD\u5E94\uFF0C\u6B63\u5E38\u8FD4\u56DE\u6570\u636E\u540E\uFF0C\u6211\u4EEC\u518D\u542F\u52A8\u5BF9 3000 \u670D\u52A1\u7684\u538B\u6D4B\uFF0C\u8FD0\u884C\u5982\u4E0B\u547D\u4EE4\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="java"><ol><li><div class="code-word">wrk -t2 -c300 -d20s http:<span class="hljs-comment">//127.0.0.1:3000/</span>\r
</div></li></ol></code></pre></div><p data-nodeid="191296">\u63A5\u4E0B\u6765\u6211\u4EEC\u770B\u4E0B\u538B\u6D4B\u540E\u7684\u6570\u636E\uFF0C\u5982\u8868 3 \u6240\u793A\uFF1A</p><p data-nodeid="217680" class=""><img src="https://s0.lgstatic.com/i/image6/M00/34/00/Cgp9HWBwD4-AFJLoAABlk46DdAs957.png" alt="Drawing 5.png" data-nodeid="217683"></p><p data-nodeid="191343">\u62FF\u5230\u538B\u6D4B\u6570\u636E\u540E\uFF0C\u540C\u6837\u6309\u7167 CPU \u5206\u6790\u65B9\u6CD5\uFF0C\u53EF\u4EE5\u770B\u5230\u5982\u56FE 4 \u6240\u793A\u7684\u6027\u80FD\u5206\u6790\u7ED3\u679C\u3002</p><p data-nodeid="221527" class=""><img src="https://s0.lgstatic.com/i/image6/M01/34/00/Cgp9HWBwD5mAFR0WAAHjSmqkmd0847.png" alt="Drawing 6.png" data-nodeid="221531"></p><div data-nodeid="221528"><p style="text-align:center;">\u56FE 4 \u7F51\u7EDC I/O \u6027\u80FD\u5206\u6790\u6570\u636E</p></div><p data-nodeid="191346">\u5176\u4E2D\u6709\u4E00\u4E2A connect\uFF0C\u8BE5\u6A21\u5757\u5728 net.js \u4E2D\uFF0C\u8FD9\u91CC\u5C31\u53EF\u4EE5\u5F97\u5230\u662F\u7F51\u7EDC I/O \u5F15\u8D77\u7684\u95EE\u9898\u3002</p><p data-nodeid="191347">\u6700\u540E\u6211\u4EEC\u518D\u6765\u770B\u4E0B \u78C1\u76D8 I/O \u7684\u95EE\u9898\u3002</p><h4 data-nodeid="191348">\u78C1\u76D8 I/O</h4><p data-nodeid="191349">\u8FD9\u91CC\u4E3B\u8981\u4F7F\u7528 Node.js \u7684 fs \u6A21\u5757\u6765\u8BFB\u53D6\u672C\u5730\u7684\u6587\u4EF6\uFF0C\u5E76\u663E\u793A\u8FD4\u56DE\u6587\u4EF6\u7684\u5185\u5BB9\uFF0C\u6838\u5FC3\u4EE3\u7801\u662F server \u56DE\u8C03\u90E8\u5206\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word"><span class="hljs-keyword">const</span> server = http.createServer(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {\r
</div></li><li><div class="code-word">    <span class="hljs-keyword">let</span> ret = fs.readFileSync(<span class="hljs-string">&#39;./test_file.conf&#39;</span>);\r
</div></li><li><div class="code-word">    res.write(ret);\r
</div></li><li><div class="code-word">    res.end();\r
</div></li><li><div class="code-word">});\r
</div></li></ol></code></pre></div><p data-nodeid="191351">\u63A5\u4E0B\u6765\uFF0C\u6211\u4EEC\u540C\u6837\u7528\u5982\u4E0B\u547D\u4EE4\u6765\u542F\u52A8\u538B\u6D4B\u670D\u52A1\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="java"><ol><li><div class="code-word">wrk -t2 -c300 -d20s http:<span class="hljs-comment">//127.0.0.1:3000/</span>\r
</div></li></ol></code></pre></div><p data-nodeid="191353">\u538B\u6D4B\u540E\u5C06\u5F97\u5230\u5982\u8868\u683C 4 \u6240\u793A\u7684\u7ED3\u679C\u3002</p><p data-nodeid="223452" class=""><img src="https://s0.lgstatic.com/i/image6/M00/34/08/CioPOWBwD6SAOvwRAAB4GHKuanE270.png" alt="Drawing 7.png" data-nodeid="223455"></p><p data-nodeid="191408">\u4ECE\u7ED3\u679C\u770B\u4E5F\u662F\u5B58\u5728\u4E00\u5B9A\u635F\u8017\u7684\uFF0C\u5177\u4F53\u5728\u54EA\u65B9\u9762\u5F71\u54CD\u5230\u6027\u80FD\uFF0C\u540C\u6837\u7528 Chrome \u5DE5\u5177\u8F7D\u5165\u8BE5\u670D\u52A1\u91C7\u96C6\u7684 CPU \u4FE1\u606F\uFF0C\u5982\u56FE 5 \u6240\u793A\u3002</p><p data-nodeid="226862"><img src="https://s0.lgstatic.com/i/image6/M00/34/00/Cgp9HWBwD6yATYtxAAHRgb9iz4o952.png" alt="Drawing 8.png" data-nodeid="226866"></p><div data-nodeid="226863" class=""><p style="text-align:center;">\u56FE 5 \u78C1\u76D8 I/O CPU \u91C7\u96C6\u4FE1\u606F</p></div><p data-nodeid="191411">\u4ECE\u56FE 5 \u4E2D\u53EF\u4EE5\u975E\u5E38\u6E05\u6670\u5730\u770B\u5230\u524D\u9762\u51E0\u4E2A\u8017\u65F6\u8F83\u957F\u7684\u90FD\u662F\u5173\u4E8E\u6587\u4EF6\u8BFB\u5199\u76F8\u5173\u7684\u6A21\u5757\uFF0C\u5982\u4E0A\u9762\u7EA2\u8272\u5708\u91CC\u9762\u7684\u4FE1\u606F\u3002</p><h3 data-nodeid="191412">\u4F18\u5316\u4EE5\u53CA\u6548\u679C</h3><p data-nodeid="191413">\u4E0A\u9762\u5DF2\u7ECF\u4ECB\u7ECD\u5230\u4E86\u90A3\u4E48\u591A\u6027\u80FD\u5F71\u54CD\u7684\u90E8\u5206\uFF0C\u90A3\u4E48\u63A5\u4E0B\u6765\u770B\u770B\u5982\u4F55\u8FDB\u884C\u4E00\u4E9B\u4F18\u5316\uFF0C\u6765\u63D0\u5347\u6027\u80FD\u3002</p><h4 data-nodeid="191414">CPU \u8BA1\u7B97\u8017\u65F6</h4><p data-nodeid="191415">\u8FD9\u90E8\u5206\u53EA\u80FD\u8BF4\u51CF\u5C11\u64CD\u4F5C\uFF0C\u6216\u8005\u51CF\u5C11\u8FD0\u7B97\u3002\u50CF\u6211\u4EEC\u4E0A\u9762\u7684\u4F8B\u5B50\uFF0C\u5982\u679C\u90FD\u662F\u4E00\u6837\u7684 MD5 \u8BA1\u7B97\uFF0C\u90A3\u4E48\u589E\u52A0\u4E00\u4E2A\u77ED\u65F6\u95F4\u7684\u7F13\u5B58\u5C31\u53EF\u4EE5\u4E86\u3002\u5F53\u7136\u8FD9\u91CC\u6211\u4EEC\u53EF\u4EE5\u76F4\u63A5\u7528\u5185\u5B58\u6765\u7F13\u5B58\uFF08\u5B9E\u9645\u5F00\u53D1\u8FC7\u7A0B\u4E2D\uFF0C\u4E0D\u80FD\u4F7F\u7528\u5185\u5B58\u7684\u65B9\u5F0F\uFF0C\u56E0\u4E3A\u4F1A\u9020\u6210\u5185\u5B58\u4F7F\u7528\u8D8A\u6765\u8D8A\u5927\uFF0C\u4E00\u822C\u4F7F\u7528\u5171\u4EAB\u5185\u5B58\uFF0C\u5E76\u77ED\u65F6\u95F4\u4FDD\u5B58\u5373\u53EF\uFF09\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF08\u4EE3\u7801\u4FDD\u5B58\u5728 cpu_opt \u4E2D\uFF09\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word">crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#39;crypto&#39;</span>);\r
</div></li><li><div class="code-word"><span class="hljs-comment">// \u4FDD\u5B58\u7F13\u5B58\u4FE1\u606F</span>\r
</div></li><li><div class="code-word"><span class="hljs-keyword">const</span> md5Cache = {};\r
</div></li><li><div class="code-word"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">content</span>) =&gt;</span> { \r
</div></li><li><div class="code-word">    <span class="hljs-keyword">if</span>(md5Cache[content]) { <span class="hljs-comment">// \u5224\u65AD\u662F\u5426\u5B58\u5728\u7F13\u5B58\u4FE1\u606F\uFF0C\u5B58\u5728\u5219\u76F4\u63A5\u8FD4\u56DE</span>\r
</div></li><li><div class="code-word">        <span class="hljs-keyword">return</span> md5Cache[content]\r
</div></li><li><div class="code-word">    }\r
</div></li><li><div class="code-word">    <span class="hljs-comment">/** \u4E0D\u5B58\u5728\u5219\u8BA1\u7B97\u5E76\u8FD4\u56DE */</span>\r
</div></li><li><div class="code-word">    md5Cache[content] = crypto.createHash(<span class="hljs-string">&#39;md5&#39;</span>).update(content).digest(<span class="hljs-string">&quot;hex&quot;</span>);\r
</div></li><li><div class="code-word">    <span class="hljs-keyword">return</span> md5Cache[content];\r
</div></li><li><div class="code-word">}\r
</div></li></ol></code></pre></div><p data-nodeid="191417"><strong data-nodeid="192020">\u6838\u5FC3\u5C31\u662F\u5728\u539F\u6765\u7684\u57FA\u7840\u4E0A\uFF0C\u589E\u52A0\u8BA1\u7B97\u7684\u7F13\u5B58\uFF0C\u907F\u514D\u591A\u6B21\u76F8\u540C\u7684\u8BA1\u7B97</strong>\uFF0C\u63A5\u4E0B\u6765\u6211\u4EEC\u538B\u6D4B\u540E\u770B\u770B\u5B9E\u9645\u7684\u6548\u679C\u6570\u636E\uFF0C\u5E76\u4E0E\u4E4B\u524D\u7684\u8FDB\u884C\u5BF9\u6BD4\uFF0C\u5F97\u5230\u7684\u7ED3\u679C\u5982\u8868 5 \u6240\u793A\u3002</p><p data-nodeid="228565" class=""><img src="https://s0.lgstatic.com/i/image6/M01/34/00/Cgp9HWBwD7aAKWHYAABelIOMBeE096.png" alt="Drawing 9.png" data-nodeid="228568"></p><p data-nodeid="191464">\u5BF9\u6BD4\u6570\u636E\u540E\uFF0C\u53EF\u4EE5\u770B\u5230\u5DF2\u7ECF\u975E\u5E38\u597D\u4E86\uFF0C\u5DF2\u7ECF\u548C\u6807\u51C6\u6570\u636E\u76F8\u5DEE\u65E0\u51E0\uFF0CQPS \u548C \u6807\u51C6\u670D\u52A1\u4E5F\u57FA\u672C\u4E00\u81F4\uFF08\u8FD9\u91CC\u6BD4\u6807\u51C6\u670D\u52A1\u9AD8\uFF0C\u662F\u56E0\u4E3A\u672C\u673A\u6D4B\u8BD5\uFF0C\u4F1A\u6709\u4E00\u5B9A\u7684\u8D77\u4F0F\uFF0C\u662F\u6B63\u5E38\u60C5\u51B5\uFF09\u3002\u4E5F\u5C31\u4EE3\u8868\u672C\u6B21\u4F18\u5316\u662F\u8FBE\u5230\u4E86\u6548\u679C\u7684\u3002</p><h4 data-nodeid="191465">\u7F51\u7EDC I/O</h4><p data-nodeid="191466">\u7F51\u7EDC I/O \u540C\u6837\u7684\u529E\u6CD5\u4E5F\u662F\u589E\u52A0\u7F13\u5B58\uFF0C\u907F\u514D\u91CD\u590D\u7684\u8BF7\u6C42\u5BFC\u81F4\u7684\u95EE\u9898\u3002\u8FD9\u91CC\u6211\u4EEC\u540C\u6837<strong data-nodeid="192085">\u7528\u7F13\u5B58\u7684\u65B9\u5F0F\u6765\u4FDD\u5B58\u8BF7\u6C42\u7ED3\u679C</strong>\uFF0C\u4F18\u5316\u7684\u4EE3\u7801\u5982\u4E0B\uFF08\u4EE3\u7801\u4FDD\u5B58\u5728 network_io_opt \u4E2D\uFF09\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word"><span class="hljs-comment">// \u5F15\u5165 request \u5E93\uFF0C\u9700\u8981\u5728 package.json \u4E2D\u7533\u660E\uFF0C\u5E76\u4E14 npm install</span>\r
</div></li><li><div class="code-word"><span class="hljs-keyword">const</span> request = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#39;request&#39;</span>);\r
</div></li><li><div class="code-word"><span class="hljs-comment">// \u7F13\u5B58 api \u8BF7\u6C42\u7ED3\u679C\u6570\u636E</span>\r
</div></li><li><div class="code-word"><span class="hljs-keyword">const</span> apiCacheData = {};\r
</div></li><li><div class="code-word"><span class="hljs-comment">/**\r
</span></div></li><li><div class="code-word"> * \r
</div></li><li><div class="code-word"> * request \u8C03\u7528\u5916\u90E8 api\r
</div></li><li><div class="code-word"> * @param {*} apiLink string\r
</div></li><li><div class="code-word"> * @param {*} callback funtion\r
</div></li><li><div class="code-word"> * \r
</div></li><li><div class="code-word"> */\r
</div></li><li><div class="code-word"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">apiLink, callback</span>) =&gt;</span> {\r
</div></li><li><div class="code-word">    <span class="hljs-keyword">if</span>(apiCacheData[apiLink]) {\r
</div></li><li><div class="code-word">        <span class="hljs-keyword">return</span> callback(apiCacheData[apiLink]);\r
</div></li><li><div class="code-word">    }\r
</div></li><li><div class="code-word">    request(apiLink, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error, response, body</span>) </span>{\r
</div></li><li><div class="code-word">        <span class="hljs-keyword">if</span>(error) {\r
</div></li><li><div class="code-word">            callback(<span class="hljs-literal">false</span>);\r
</div></li><li><div class="code-word">        } <span class="hljs-keyword">else</span> {\r
</div></li><li><div class="code-word">            apiCacheData[apiLink] = body;\r
</div></li><li><div class="code-word">            callback(body);\r
</div></li><li><div class="code-word">        }\r
</div></li><li><div class="code-word">    });\r
</div></li><li><div class="code-word">}\r
</div></li></ol></code></pre></div><p data-nodeid="191468"><strong data-nodeid="192090">\u5176\u6B21\u4E3A\u4E86\u670D\u52A1\u6027\u80FD\u8003\u8651\uFF0C\u6211\u4EEC\u53EF\u4EE5\u8003\u8651\u653E\u5F03\u90E8\u5206\u8D85\u65F6\u8BF7\u6C42\uFF0C\u4ECE\u800C\u63D0\u5347\u670D\u52A1\u6027\u80FD</strong>\u3002\u907F\u514D\u56E0\u4E3A\u90E8\u5206\u8BF7\u6C42\u8FD4\u56DE\u6162\uFF0C\u5BFC\u81F4\u6574\u4F53\u670D\u52A1\u88AB block \u4F4F\uFF0C\u4FEE\u6539 request \u90E8\u5206\u589E\u52A0\u8D85\u65F6\u5904\u7406\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">apiLink, callback</span>) =&gt;</span> {\r
</div></li><li><div class="code-word">    <span class="hljs-keyword">if</span>(apiCacheData[apiLink]) {\r
</div></li><li><div class="code-word">        <span class="hljs-keyword">return</span> callback(apiCacheData[apiLink]);\r
</div></li><li><div class="code-word">    }\r
</div></li><li><div class="code-word">    request(apiLink, {<span class="hljs-attr">timeout</span>: <span class="hljs-number">3000</span>}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error, response, body</span>) </span>{\r
</div></li><li><div class="code-word">        <span class="hljs-keyword">if</span>(error) {\r
</div></li><li><div class="code-word">            callback(<span class="hljs-literal">false</span>);\r
</div></li><li><div class="code-word">        } <span class="hljs-keyword">else</span> {\r
</div></li><li><div class="code-word">            apiCacheData[apiLink] = body;\r
</div></li><li><div class="code-word">            callback(body);\r
</div></li><li><div class="code-word">        }\r
</div></li><li><div class="code-word">    });\r
</div></li><li><div class="code-word">}\r
</div></li></ol></code></pre></div><p data-nodeid="191470">\u5B9E\u9645\u60C5\u51B5\u9700\u8981\u6839\u636E\u5177\u4F53\u7684\u63A5\u53E3\u6027\u80FD\u6765\u8BBE\u7F6E\u8FD9\u4E2A\u8D85\u65F6\u65F6\u95F4\uFF0C\u907F\u514D\u8D85\u65F6\u65F6\u95F4\u8FC7\u5EA6\u5F71\u54CD\u670D\u52A1\uFF0C\u4E5F\u907F\u514D\u65F6\u95F4\u8FC7\u957F\u65E0\u6CD5\u8FBE\u5230\u6548\u679C\u3002</p><p data-nodeid="191471">\u4F18\u5316\u5B8C\u6210\u540E\uFF0C\u540C\u6837\u6211\u4EEC\u518D\u8DD1\u4E00\u904D\u6D4B\u8BD5\u6570\u636E\uFF1A</p><ul data-nodeid="191472"><li data-nodeid="191473"><p data-nodeid="191474">\u9996\u5148\u8FD8\u662F\u5148\u53BB api_server \u4E2D\u542F\u52A8 api \u670D\u52A1\uFF1B</p></li><li data-nodeid="191475"><p data-nodeid="191476">\u63A5\u4E0B\u6765\u518D\u542F\u52A8\u672C\u6587\u4EF6\u5939 network_io_opt \u7684\u670D\u52A1\uFF1B</p></li><li data-nodeid="191477"><p data-nodeid="191478">\u542F\u52A8\u5B8C\u6210\u540E\uFF0C\u518D\u8FDB\u884C\u538B\u6D4B\u3002</p></li></ul><p data-nodeid="191479" class="">\u53EF\u4EE5\u5F97\u5230\u8868 6 \u7684\u538B\u6D4B\u5BF9\u6BD4\u6570\u636E\u3002</p><p data-nodeid="230077" class=""><img src="https://s0.lgstatic.com/i/image6/M00/34/00/Cgp9HWBwD8GACAFLAABqJCdynds886.png" alt="Drawing 10.png" data-nodeid="230080"></p><p data-nodeid="191526">\u4ECE\u7ED3\u679C\u4E2D\u53EF\u4EE5\u770B\u51FA\u4F18\u5316\u6548\u679C\u975E\u5E38\u660E\u663E\uFF0C\u4E00\u4E2A\u7B80\u5355\u7684\u4F18\u5316\u5C31\u53EF\u4EE5\u5C06\u539F\u6765 272.96 \u7684 QPS \u63D0\u5347\u5230 31503.58\u3002</p><p data-nodeid="191527">\u6700\u540E\u6211\u4EEC\u518D\u6765\u770B\u770B\u78C1\u76D8 I/O \u7684\u4F18\u5316\u3002</p><h4 data-nodeid="191528">\u78C1\u76D8 I/O</h4><p data-nodeid="191529"><strong data-nodeid="192163">\u78C1\u76D8 I/O \u7684\u4F18\u5316\u5206\u4E3A\u8BFB\u4F18\u5316\u548C\u5199\u4F18\u5316</strong>\uFF0C\u4F18\u5316\u7684\u7B56\u7565\u6709\uFF1A</p><ul data-nodeid="191530"><li data-nodeid="191531"><p data-nodeid="191532">\u4E3A\u4E86\u63D0\u5347\u6027\u80FD\u9700\u8981\u5C06\u540C\u6B65\u4FEE\u6539\u5F02\u6B65\uFF0C\u907F\u514D\u5F71\u54CD\u4E3B\u7EBF\u7A0B\u7684\u6027\u80FD\uFF1B</p></li><li data-nodeid="191533"><p data-nodeid="191534">\u8BFB\u4F18\u5316\uFF0C\u5FC5\u987B\u589E\u52A0\u5FC5\u8981\u7684\u7F13\u5B58\uFF0C\u51CF\u5C11\u76F8\u540C\u6587\u4EF6\u7684\u91CD\u590D\u8BFB\u53D6\uFF1B</p></li><li data-nodeid="191535"><p data-nodeid="191536">\u5199\u4F18\u5316\uFF0C\u53EF\u4EE5\u4F7F\u7528\u5F02\u6B65\u5199\u6587\u4EF6\u7684\u65B9\u5F0F\uFF0C\u5148\u5C06\u5199\u5185\u5BB9\u7F13\u5B58\u5230\u961F\u5217\uFF08\u5982\u6211\u4EEC\u7B2C\u4E00\u90E8\u5206\u7684\u7B2C 08 \u8BB2\u7684\u65B9\u6848\uFF09\uFF1B</p></li><li data-nodeid="191537"><p data-nodeid="191538">\u5408\u5E76\u591A\u6B21\u5199\u64CD\u4F5C\uFF0C\u907F\u514D\u9891\u7E41\u6253\u5F00\u6587\u4EF6\uFF0C\u8BFB\u5199\u6587\u4EF6\u5185\u5BB9\u3002</p></li></ul><p data-nodeid="191539">\u5F53\u7136\u5BF9\u4E8E\u672C\u8BB2\uFF0C\u6211\u4EEC\u7740\u91CD\u4F18\u5316 2 \u70B9\uFF1A</p><ul data-nodeid="191540"><li data-nodeid="191541"><p data-nodeid="191542">\u4FEE\u6539\u4E3A\u5F02\u6B65</p></li><li data-nodeid="191543"><p data-nodeid="191544">\u589E\u52A0\u7F13\u5B58</p></li></ul><p data-nodeid="191545">\u4F18\u5316\u4EE3\u7801\u5982\u4E0B\uFF08\u4EE3\u7801\u5728 disk_io_opt \u4E2D\uFF09\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word"><span class="hljs-keyword">const</span> server = http.createServer(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {\r
</div></li><li><div class="code-word">    fs.readFile(<span class="hljs-string">&#39;./test_file.conf&#39;</span>, (err, data) =&gt; {\r
</div></li><li><div class="code-word">        <span class="hljs-keyword">if</span> (err) {\r
</div></li><li><div class="code-word">            res.write(<span class="hljs-string">&#39;error read file&#39;</span>);\r
</div></li><li><div class="code-word">            res.end();\r
</div></li><li><div class="code-word">        } <span class="hljs-keyword">else</span> {\r
</div></li><li><div class="code-word">            res.write(data);\r
</div></li><li><div class="code-word">            res.end();\r
</div></li><li><div class="code-word">        }\r
</div></li><li><div class="code-word">    });\r
</div></li><li><div class="code-word">});\r
</div></li></ol></code></pre></div><p data-nodeid="191547">\u63A5\u4E0B\u6765\u7EE7\u7EED\u538B\u6D4B\u770B\u4E0B\u6548\u679C\uFF0C\u5982\u8868 7 \u6240\u793A\uFF1A</p><p data-nodeid="231399" class=""><img src="https://s0.lgstatic.com/i/image6/M00/34/00/Cgp9HWBwD8qATRwGAABrIJLpIKs046.png" alt="Drawing 11.png" data-nodeid="231402"></p><p data-nodeid="191594">\u4ECE\u4E0A\u9762\u770B\u5F97\u51FA\u5F02\u6B65 I/O \u5BF9\u670D\u52A1\u6027\u80FD\u63D0\u5347\u8FD8\u662F\u6BD4\u8F83\u7A81\u51FA\uFF0C\u4E5F\u662F\u6BD4\u8F83\u5173\u952E\u7684\u3002\u5982\u679C\u6587\u4EF6\u5927\u4F1A\u66F4\u7A81\u51FA\uFF0C\u56E0\u6B64\u5728\u5E73\u65F6\u4EE3\u7801\u4E2D\u8981\u975E\u5E38\u6CE8\u91CD\u8FD9\u70B9\uFF0C\u51CF\u5C11\u540C\u6B65\u8BFB\u5199\u7684\u64CD\u4F5C\u3002</p><p data-nodeid="191595">\u90A3\u4E48\u5982\u679C\u6211\u4EEC\u7EE7\u7EED\u4F18\u5316\uFF0C\u589E\u52A0\u7F13\u5B58\u5462\uFF1F\u6211\u4EEC\u6765\u770B\u4E0B\u6548\u679C\uFF0C\u4FEE\u6539\u4E0B\u9762\u4EE3\u7801\uFF1A</p><div class="course-code-area"><div class="copy-btn"><div class="copy-icon"></div>\u590D\u5236\u4EE3\u7801</div><pre><code data-language="javascript"><ol><li><div class="code-word"><span class="hljs-comment">// \u6587\u4EF6\u7F13\u5B58</span>\r
</div></li><li><div class="code-word"><span class="hljs-keyword">let</span> fileCache;\r
</div></li><li><div class="code-word"><span class="hljs-comment">/**\r
</span></div></li><li><div class="code-word"> * \r
</div></li><li><div class="code-word"> * \u521B\u5EFA http \u670D\u52A1\uFF0C\u7B80\u5355\u8FD4\u56DE\r
</div></li><li><div class="code-word"> */\r
</div></li><li><div class="code-word"><span class="hljs-keyword">const</span> server = http.createServer(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {\r
</div></li><li><div class="code-word">    <span class="hljs-keyword">if</span>(fileCache) {\r
</div></li><li><div class="code-word">        res.write(fileCache);\r
</div></li><li><div class="code-word">        res.end();\r
</div></li><li><div class="code-word">        <span class="hljs-keyword">return</span>;\r
</div></li><li><div class="code-word">    }\r
</div></li><li><div class="code-word">    fs.readFile(<span class="hljs-string">&#39;./test_file.conf&#39;</span>, (err, data) =&gt; {\r
</div></li><li><div class="code-word">        <span class="hljs-keyword">if</span> (err) {\r
</div></li><li><div class="code-word">            res.write(<span class="hljs-string">&#39;error read file&#39;</span>);\r
</div></li><li><div class="code-word">            res.end();\r
</div></li><li><div class="code-word">        } <span class="hljs-keyword">else</span> {\r
</div></li><li><div class="code-word">            fileCache = data;\r
</div></li><li><div class="code-word">            res.write(data);\r
</div></li><li><div class="code-word">            res.end();\r
</div></li><li><div class="code-word">        }\r
</div></li><li><div class="code-word">    });\r
</div></li><li><div class="code-word">});\r
</div></li></ol></code></pre></div><p data-nodeid="191597">\u5E76\u4E14\u91CD\u65B0\u538B\u6D4B\u770B\u4E0B\u6570\u636E\uFF0C\u5982\u8868\u683C 8 \u6240\u793A\u3002</p><p data-nodeid="232531" class=""><img src="https://s0.lgstatic.com/i/image6/M00/34/08/CioPOWBwD9KAICB5AAB9TVaRLF4498.png" alt="Drawing 12.png" data-nodeid="232534"></p><p data-nodeid="191652">\u4ECE\u7ED3\u679C\u770B\u5DF2\u7ECF\u548C\u6807\u51C6\u7684\u6570\u636E\u975E\u5E38\u63A5\u8FD1\uFF0C\u56E0\u6B64<strong data-nodeid="192298">\u5728 Node.js \u5F00\u53D1\u8FC7\u7A0B\u4E2D\uFF0C\u8981\u7279\u522B\u6CE8\u610F\u6587\u4EF6\u8BFB\u53D6\uFF0C\u907F\u514D\u76F8\u540C\u6587\u4EF6\u7684\u91CD\u590D\u8BFB\u53D6</strong>\u3002\u4ECE\u8868\u683C 8 \u4E2D\u7684\u5F02\u6B65\u548C\u7F13\u5B58\u6570\u636E\u5BF9\u6BD4\u6765\u770B\uFF0C\u901A\u8FC7\u7F13\u5B58\u7684\u5904\u7406\u4F18\u5316\uFF0C\u5C31\u53EF\u4EE5\u5728 QPS \u4E0A\u4ECE 18353.39 \u63D0\u5347\u81F3 35058.79\uFF0C\u6709 91% \u4EE5\u4E0A\u7684\u6027\u80FD\u63D0\u5347\u3002</p><h3 data-nodeid="191653">\u603B\u7ED3</h3><p data-nodeid="191654">\u5B66\u5B8C\u672C\u8BB2\uFF0C\u4F60\u5E94\u8BE5\u8981\u638C\u63E1\u4E24\u4E2A\u5DE5\u5177\u7684\u5E94\u7528\uFF0C\u5BF9\u4E8E\u670D\u52A1\u7AEF\u7814\u53D1\u6765\u8BF4\u8FD9\u4E9B\u5DE5\u5177\u662F\u975E\u5E38\u91CD\u8981\u7684\uFF0C\u6211\u5E0C\u671B\u4F60\u80FD\u6DF1\u5165\u53BB\u5B9E\u8DF5\u5E94\u7528\u8FD9\u4E24\u4E2A\u5DE5\u5177\u3002\u5176\u6B21\u4E86\u89E3 3 \u79CD\u5F71\u54CD\u6027\u80FD\u56E0\u7D20\u7684\u4F18\u5316\u7B56\u7565\uFF0C\u540C\u65F6\u5728\u65E5\u5E38\u5F00\u53D1\u4E2D\uFF0C\u5E94\u5C3D\u91CF\u907F\u514D\u5F71\u54CD\u6027\u80FD\u7684\u4EE3\u7801\u903B\u8F91\u3002</p><p data-nodeid="191655">\u90A3\u4F60\u5728\u5B9E\u9645\u7684\u5DE5\u4F5C\u4E2D\uFF0C\u662F\u5982\u4F55\u63D0\u5347\u6027\u80FD\u7684\u5462\uFF0C\u6B22\u8FCE\u5728\u8BC4\u8BBA\u533A\u5206\u4EAB\u4F60\u7684\u7ECF\u9A8C\u3002</p><p data-nodeid="233443">\u8FD9\u4E00\u8BB2\u5C31\u8BB2\u5B8C\u4E86\uFF0C\u4E0B\u4E00\u8BB2\u5C06\u8BB2\u89E3\u201C\u5E38\u89C1\u7F51\u7EDC\u653B\u51FB\u4EE5\u53CA\u9632\u62A4\u7B56\u7565\u201D\uFF0C\u5230\u65F6\u89C1~</p><hr data-nodeid="191661"><p data-nodeid="191033"><a href="https://shenceyun.lagou.com/t/mka" data-nodeid="191040"><img src="https://s0.lgstatic.com/i/image6/M00/12/FA/CioPOWBBrAKAAod-AASyC72ZqWw233.png" alt="Drawing 2.png" data-nodeid="191039"></a></p><p data-nodeid="191034"><strong data-nodeid="191044">\u300A\u5927\u524D\u7AEF\u9AD8\u85AA\u8BAD\u7EC3\u8425\u300B</strong></p><p data-nodeid="191035" class="">\u5BF9\u6807\u963F\u91CC P7 \u6280\u672F\u9700\u6C42 + \u6BCF\u6708\u5927\u5382\u5185\u63A8\uFF0C6 \u4E2A\u6708\u52A9\u4F60\u65A9\u83B7\u540D\u4F01\u9AD8\u85AA Offer\u3002<a href="https://shenceyun.lagou.com/t/mka" data-nodeid="191048">\u70B9\u51FB\u94FE\u63A5</a>\uFF0C\u5FEB\u6765\u9886\u53D6\uFF01</p></div></div>`,2),w=[c,r,p,t,v,h];function g(u,j){return d(),i("div",o,w)}var b=e(n,[["render",g]]);export{b as default};
